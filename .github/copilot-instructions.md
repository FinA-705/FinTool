# COPILOT 编辑操作指南

## 首要指令

    避免同时处理多个文件。
    同时对一个文件进行多次编辑会导致文件损坏。
    编码时要边写边解释你在做什么。

## 大型文件和复杂更改协议

### 强制性规划阶段

    处理大型文件（>300行）或复杂更改时：
    	1. 在进行任何编辑之前，务必先制定详细的计划
            2. 你的计划必须包括：
                   - 所有需要修改的函数/部分
                   - 应应用更改的顺序
                   - 更改之间的依赖关系
                   - 预计所需的单独编辑次数

            3. 将你的计划格式化为：

## 建议的编辑计划

    处理文件： [文件名]
    计划总编辑次数： [数字]

### 进行编辑

    - 一次只关注一个概念性更改
    - 在提出更改时，显示清晰的“之前”和“之后”代码片段
    - 包含对更改内容和原因的简明解释
    - 始终检查编辑是否保持了项目的编码风格

### 编辑顺序：

    1. [第一个具体更改] - 目的： [原因]
    2. [第二个具体更改] - 目的： [原因]
    3. 你批准这个计划吗？在您确认后，我将继续进行编辑 [数字]。
    4. 在用户明确确认之前，请等待，用户确认编辑 [数字] 后再进行任何编辑

### 执行阶段

    - 每次单独编辑后，都要清楚地表明进度：
    	"✅ 已完成 [总计] 中的编辑 [#]。准备进行下一个编辑？"
    - 如果你在编辑过程中发现需要进行其他更改：
    - 停止并更新计划
    - 在继续之前获得批准

### 重构指导

    重构大型文件时：
    - 将工作分解成逻辑上独立的、功能独立的块
    - 确保每个中间状态都保持功能
    - 将临时复制视为有效的中间步骤
    - 始终指明正在应用的重构模式

### 避免速率限制

    - 对于非常大的文件，建议将更改分成多个会话进行
    - 优先处理逻辑上完整的单元更改
    - 始终提供清晰的停止点

## 通用要求

    对于所有代码建议，请使用如下所述的现代技术。优先考虑简洁、易于维护的代码以及适当的注释。

### 可访问性

    - 确保符合 **WCAG 2.1** AA 级最低标准，尽可能达到 AAA 级。
    - 始终建议：
    - 表单字段的标签。
    - 正确的 **ARIA** 角色和属性。
    - 足够的色彩对比度。
    - 媒体元素的替代文本（`alt`, `aria-label`）。
    - 语义化HTML以确保清晰的结构。
    - 使用诸如 **Lighthouse** 之类的工具进行审核。

## 文档要求

    - 为 JavaScript/TypeScript 包含 JSDoc 注释。
    - 使用清晰的示例记录复杂的函数。
    - 保持简洁的 Markdown 文档。
    - 最低文档块信息： `param`, `return`, `throws`, `author`

## 数据库要求 (SQLite 3.46+)

    - 利用 JSON 列、生成的列、严格模式、外键、检查约束和事务。

## 安全注意事项

    - 彻底清理所有用户输入。
    - 参数化数据库查询。
    - 实施严格的内容安全策略 (CSP)。
    - 在适用情况下使用 CSRF 保护。
    - 确保安全 Cookie（`HttpOnly`, `Secure`, `SameSite=Strict`）。
    - 限制权限并实施基于角色的访问控制。
    - 实施详细的内部日志记录和监控。
